select knt_pelny_numer, ks_kwota, ks_tresc
, ks_knt_wn, ks_knt_ma
, case when ks_knt_wn is not null then ks_kwota else 0 end wn
, case when ks_knt_ma is not null then -ks_kwota else 0 end ma
, case when ks_knt_wn is not null then ks_kwota else 0 end + case when ks_knt_ma is not null then -ks_kwota else 0 end saldo
from kgt_ksiegowania, kgt_dokumenty, kg_konta 
where ks_dok_id = dok_id 
and dok_data_zaksiegowania between :1 and :2 
and (ks_knt_wn = knt_id or ks_knt_ma = knt_id) 
AND (ks_f_zaksiegowany = 'T' or ks_f_symulacja = 'T') 
--AND ks_rodzaj = 'PK' 
and knt_pelny_numer like '234%02' 

